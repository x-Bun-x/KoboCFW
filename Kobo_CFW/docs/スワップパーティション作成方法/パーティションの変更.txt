2012/11/19 by 859

*** この手順書の内容 ***
この手順書では、初心者にハードルが高いデータ領域の拡張とスワップ領域の確保について解説しています。



*** 注意 ***
この手順書は自身の環境でテストしたものであり、全てのkobo,PCで動作を保証するものではありません。
分解、改造、ファームウエアの書き換えは個人の責任で行ってください。
当然ですが、バックアップしたファイルサイズよりも小さいSDは使えません。
Class2は本当に遅い。koboの起動/電源OFF/USBの安全な取り外し/ファームアップ全てにおいて遅くなるのでお勧めしません。



*** 内蔵SDのサイズアップ手順 ***
1.必要なソフトを用意する。
  DD for Windows
  	http://www.si-linux.co.jp/pub/DDforWindows/DDWin_Ver0996.zip
  MiniTool Partition Wizard Home Edition
  	http://www.partitionwizard.com/download.html


2.買ってきたばかりのkoboは電源を入れる前にSDの内容をバックアップしておきましょう。
  注)カバーの開け方は他のサイトで紹介されているので、そちらをご確認ください。
  1.取り出した内蔵SDをPCに接続し、DD for Windowsを起動。
  2.対象ディスクが目的のSDになっているか確認。サイズは1886.0MBぐらいになっているはずなので、それ以外なら[ディスク選択]ボタンを押して変更します。
  3.[ファイル選択]ボタンを押して書き出すファイル名を決める。
  4.[>>読込>>]ボタンを押して内容を吸い出す。結構時間がかかる。


3.新しいSDを用意してデータを書き込む。
  1.新しいSDをPCに接続。DD for Windowsを起動しなおして認識させる。対象ディスクで表示されているサイズを目安に新しいSDを選択します。
  2.先ほどバックアップしたファイルを選択します。
  3.[<<書込<<]を押して書き込む。確認画面が2〜3回表示されるが、全て[はい]を選択。書き込みも結構時間がかかる。


4.パーティションを拡張する。
  注)パーティションの縮小はお勧めできませんので、スワップ領域を割り当てる方はどれぐらい割り当てるか考えておいてください。
  注)分かりにくいと思うので、画面のプレビューをつけておきます。
  1.MiniTool Partition Wizard Home Editionを起動。目的のSDを容量を頼りに探します。
  2.3つ目のパーティション「KOBOeReader」を右クリックして[Move/Resize]を選択。
  3.バーをドラッグして拡張後のサイズを決める。スワップを作る場合は末尾の領域に必要なサイズを残しておきます。
  4.4つ目の空き領域を右クリックして[Create]を選択。確認画面が出てくるので[Yes]を選択。
  5.パーティションのパラメータを設定。Create As:Primary  File System:Linux Swap  それ以外は触らない。
  6.ウインドウ左上の[Apply]ボタンを押してSDに書き込む。これを押すまではSDのデータは変更されていない。少し時間がかかる。[Discard]を押すとこれまでの変更内容を破棄できる。
  7.Successfulメッセージが出たら完了。
  8.koboにSDを取り付けて起動させます。データ領域をいじくって気持ち悪い人はファクトリーリセットをかけると再フォーマットされるのでお勧めです。


*** スワップパーティションの話 ***
1.スワップパーティションはkoboの正規ファームでは一切使用されません。必ずカスタムファームを導入してください。
2.スワップパーティションの使用状況はtelnetでログインしてからfreeコマンドで確認できます。
3.システムの空きメモリやCPUの使用状況はtopコマンドで確認できます。終了するにはCtrl-Cで終了します。


*** その他 ***
改造していないkoboの内蔵SDは以下のように割り当てられています。
	10MB		空き
p1	256MB	Linux	通常起動システム
p2	256MB	Linux	工場出荷リカバリ用システム
p3	1.3GB	FAT32	データ領域

工場出荷にリカバリを行うとp1とp3の領域は再フォーマットされるので、ファイルシステムがおかしくなった場合はリカバリを行うべきです。
p3の領域を MiniTool Partition Wizard Home Edition で縮小してスワップを作った場合も、精神衛生上気持ち悪い方はリカバリしてください。
リカバリは、電源を切った状態でHOMEボタンを押しながら電源を入れます。LEDが青→緑→赤→緑→白点滅でリカバリモードです。
